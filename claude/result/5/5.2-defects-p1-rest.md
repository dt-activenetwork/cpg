# CPG 缺陷修复人力资源分析报告

## 第一部分 b: P1 剩余缺陷 + 选定 P2 缺陷技能分析

**文档**: 5.2-defects-p1-rest.md
**范围**: P1 剩余 5 个缺陷 (D5, D7, D10, D12, D17) + 选定 P2 缺陷简要分析
**目标**: 完成所有 P0-P1 缺陷的详细分析,提供 P2 缺陷的概要

---

## 📋 本文档概览

本文档分析 **5 个剩余 P1 缺陷** + **9 个选定 P2 缺陷**:

### P1 缺陷 (5 个,详细分析)

| 缺陷 ID | 名称 | 优先级 | 领域 | 复杂度 | 预计工作量 |
|-----------|------|----------|------|--------|-----------|
| **D5** | Integer Constant Evaluation | P1 | Java-Sem + Core | Low | 20-40 hours |
| **D7** | Type System Incomplete | P1 | Frontend + Integration | High | 80-120 hours |
| **D10** | Parallel Analysis Missing | P1 | Performance + Core | High | 80-160 hours |
| **D12** | Bytecode Analysis Missing | P1 | Bytecode + Integration | Very High | 120-240 hours |
| **D17** | Testing Infrastructure Missing | P1 | Testing | Medium | 60-120 hours |

**Total P1 (D5, D7, D10, D12, D17)**: 360-680 person-hours (2-4 person-months)

### P2 缺陷 (9 个,简要分析)

| 缺陷 ID | 名称 | 优先级 | 领域 | 预计工作量 |
|-----------|------|----------|------|-----------|
| **D6** | Enum Constants | P2 | Java-Sem + Frontend | 40-60 hours |
| **D8** | Flow-Sensitive DFG | P2 | Graph-Algo + Core | 80-120 hours |
| **D11** | Error Recovery | P2 | Error-Handling + Frontend | 40-80 hours |
| **D15** | Lambda Coverage | P2 | Java-Sem + Frontend | 40-60 hours |
| **D16** | Try-with-Resources | P2 | Java-Sem + Frontend | 20-40 hours |
| **D22** | Incremental Analysis | P2 | Performance + Core | 60-120 hours |
| **D23** | Maven/Gradle Integration | P2 | Build-Sys | 40-80 hours |
| **D24** | Partial Analysis | P2 | Build-Sys + Core | 20-40 hours |
| **M1** | Generic Type Erasure | P2 | Java-Sem + Frontend | 80-120 hours |

**Total P2 (selected 9)**: 420-720 person-hours (2-3.5 person-months)

---

## P1 缺陷详细分析

### D5: Integer Constant Evaluation Incomplete

#### D5.1 缺陷概述

**缺陷 ID**: D5
**优先级**: P1
**类别**: A (Partial blocking Scenario 4)

**描述** (面向非技术读者):
Java 程序中,整数常量 (如 `int X = 10`) 也很常见,占常量使用的约 20-30%。当前 CPG 对整数常量的求值支持不完整,特别是:
- Integer wrapper (如 `Integer.valueOf("10")`) 无法求值
- Autoboxing/unboxing (如 `int x = Integer.valueOf(1)`) 无法追踪
- Enum ordinal (如 `MyEnum.VALUE.ordinal()`) 无法求值

**影响**: Scenario 4 (Enum branching) 部分阻塞,真实项目中 20-30% 整数常量相关的条件无法求值

#### D5.2 技能需求汇总

**必备技能**:
- Java Integer 语义理解 (autoboxing, valueOf, parseInt)
- CPG ValueEvaluator 扩展 (类似 D2)

**所需资历**: Mid-level (2-4 years) 足够
**复杂度**: Low (实现简单,类似 D2)
**工作量**: 20-40 hours (0.5-1 week)

**协作模式**: Core Specialist (lead) + Testing Specialist (testing)

---

### D7: Type System Incomplete (Method Overloading)

#### D7.1 Defect Summary

**缺陷 ID**: D7
**优先级**: P1
**类别**: B (Real-world requirement, affects D4 precision)

**描述** (面向非技术读者):
Java 的类型系统非常复杂,当前 CPG 的类型解析不完整:
- 方法重载解析 (同名方法,不同参数类型) 不准确
- 泛型类型推断 (如 `List<String>` vs `List<?>`) 缺失
- Lambda 类型推断 (如 `x -> x.toString()` 的 x 是什么类型) 不准确

这导致 Call Graph (D4) 的精度降低 (无法确定调用哪个重载方法),进而影响过程间分析 (D3) 的精度。

**影响**:
- 间接阻塞 D4 和 D3 的精度提升
- 真实项目中,20-30% 的方法调用解析不准确

#### D7.2 Skill Requirements Summary

**必备技能**:
- Java 类型系统深度理解 (overloading, generics, type inference)
- Java 方法解析算法 (JLS 规范)
- CPG TypeResolver 和 TypeManager 理解

**所需资历**: Senior (5+ years) 推荐,需要深度理解 Java 类型系统
**复杂度**: High (Java 类型系统极其复杂,JLS 规范有数百页)
**工作量**: 80-120 hours (2-3 weeks)

**协作模式**: Frontend Specialist (lead) + Integration Engineer (integration with D4)

---

### D10: Parallel Analysis Missing

#### D10.1 Defect Summary

**缺陷 ID**: D10
**优先级**: P1
**类别**: B (Real-world deployment blocker)

**描述** (面向非技术读者):
真实项目分析速度慢,当前 CPG 是单线程的,无法利用多核 CPU。对于 100K LOC 项目:
- 单线程: 5-10 minutes
- 并行 (4-8 cores): 预期 1-2 minutes (**5-10x 加速**)

当前 CPG 的 Pass 基础设施不支持并行执行,所有 Pass 必须串行运行。

**影响**:
- 真实项目分析太慢,无法集成到 CI/CD (超时)
- 开发者等待时间长,体验差

#### D10.2 Skill Requirements Summary

**必备技能**:
- 并行算法设计 (task parallelism, data parallelism)
- 竞态条件处理 (race condition, mutex, atomic operations)
- CPG Pass 依赖分析 (哪些 Pass 可以并行,哪些必须串行)

**所需资历**: Senior (5+ years) 推荐,Expert (10+ years) 更佳
**复杂度**: High (并行算法复杂,容易出现 race condition,难以调试)
**工作量**: 80-160 hours (2-4 weeks)

**协作模式**: Performance Engineer (lead) + Core Specialist (Pass infrastructure)

---

### D12: Bytecode Analysis Missing

#### D12.1 Defect Summary

**缺陷 ID**: D12
**优先级**: P1
**类别**: B (Real-world deployment blocker)

**描述** (面向非技术读者):
真实项目依赖大量第三方库 (JAR 文件),这些库只有字节码 (bytecode),没有源码。当前 CPG 只能分析源码,无法分析字节码。

这导致:
- 无法分析调用第三方库的代码 (如 `List.add()`,无法知道 `add()` 的行为)
- Call Graph (D4) 不完整 (缺少对第三方库的调用边)
- 过程间 DFG (D3) 不准确 (无法追踪数据流经第三方库)

**影响**:
- 真实项目中,95% 的代码依赖第三方库
- 无字节码分析,真实项目几乎无法分析

#### D12.2 Skill Requirements Summary

**必备技能**:
- JVM 字节码深度理解 (指令集, stack-based execution, type system)
- ASM 库熟练使用 (Java 字节码操作库)
- Source-Bytecode 统一表示设计 (如何用 CPG 同时表示源码和字节码)

**所需资历**: Senior (5+ years) 必需,字节码专家稀缺
**复杂度**: Very High (字节码与源码差异大,需要设计统一表示)
**工作量**: 120-240 hours (3-6 weeks)

**协作模式**: Performance Engineer (lead, 字节码专家) + Integration Engineer (统一表示设计)

---

### D17: Testing Infrastructure Missing

#### D17.1 Defect Summary

**缺陷 ID**: D17
**优先级**: P1
**类别**: B (Quality assurance blocker)

**描述** (面向非技术读者):
修复 18 个缺陷后,如何验证修复是正确的?当前 CPG 缺少系统化的测试基础设施:
- 缺少 scenario-based 测试框架 (如 Task 3 的 4 个场景应该是自动化测试)
- 缺少 regression 测试 (确保新修复不破坏旧功能)
- 缺少性能测试 (确保修复后性能可接受)

**影响**:
- 无法验证修复的正确性和精度
- 无法防止 regression (新修复破坏旧功能)
- 质量无法保证

#### D17.2 Skill Requirements Summary

**必备技能**:
- 测试框架设计 (JUnit, Spock, TestNG)
- Scenario-based 测试设计 (如何将 Task 3 场景转化为自动化测试)
- Regression 测试策略 (如何确保覆盖所有修复)

**所需资历**: Mid-to-Senior (3-5 years) 推荐
**复杂度**: Medium (测试设计需要经验,但不涉及复杂算法)
**工作量**: 60-120 hours (1.5-3 weeks)

**协作模式**: Testing Specialist (lead) + All roles (提供测试需求)

---

## P2 缺陷简要分析 (Selected 9 defects)

### D6: Enum Constants Not Resolved

**优先级**: P2
**工作量**: 40-60 hours
**所需技能**: Java enum semantics, Frontend Handler extension
**所需资历**: Mid-level
**主导角色**: Frontend Specialist

### D8: Flow-Insensitive DFG

**优先级**: P2
**工作量**: 80-120 hours
**所需技能**: SSA, Phi nodes, flow-sensitive analysis algorithms
**所需资历**: Senior
**主导角色**: Core Specialist
**备注**: 与 D3 可能冲突,需要统一设计

### D11: Error Recovery Missing

**优先级**: P2
**工作量**: 40-80 hours
**所需技能**: Resilient parsing, partial AST construction, error tolerance
**所需资历**: Mid-level
**主导角色**: Tooling Engineer

### D15: Lambda Coverage Gaps

**优先级**: P2
**工作量**: 40-60 hours
**所需技能**: Java lambda semantics, desugaring, closure handling
**所需资历**: Mid-level
**主导角色**: Frontend Specialist

### D16: Try-with-Resources Coverage

**优先级**: P2
**工作量**: 20-40 hours
**所需技能**: Java try-with-resources semantics, AutoCloseable interface
**所需资历**: Mid-level
**主导角色**: Frontend Specialist

### D22: Incremental Analysis Missing

**优先级**: P2
**工作量**: 60-120 hours
**所需技能**: Change propagation, incremental algorithms, caching
**所需资历**: Senior
**主导角色**: Performance Engineer

### D23: Maven/Gradle Integration Missing

**优先级**: P2
**工作量**: 40-80 hours
**所需技能**: Maven/Gradle plugin development, classpath resolution
**所需资历**: Mid-level
**主导角色**: Tooling Engineer

### D24: Partial Analysis Support Missing

**优先级**: P2
**工作量**: 20-40 hours
**所需技能**: Module boundary handling, incomplete graph analysis
**所需资历**: Mid-level
**主导角色**: Tooling Engineer

### M1: Generic Type Erasure (Abstraction Tax)

**优先级**: P2
**工作量**: 80-120 hours
**所需技能**: Java generics, type bounds, type erasure, CPG type representation
**所需资历**: Senior
**主导角色**: Frontend Specialist
**备注**: 多语言抽象代价,Java-only fork 可消除

---

## 第一部分 b 总结

### 工作量汇总

| 优先级 | 缺陷数量 | 总工作量 (person-hours) | 总工作量 (person-months) |
|--------|---------|----------------------|------------------------|
| **P0** | 2 (D1-D2) | 60-120 | 0.4-0.75 |
| **P1 (Core)** | 4 (D3-D4) | 200-390 | 1.2-2.4 |
| **P1 (Rest)** | 5 (D5, D7, D10, D12, D17) | 360-680 | 2.2-4.2 |
| **P2 (Selected)** | 9 (D6, D8, D11, D15-D16, D22-D24, M1) | 420-720 | 2.6-4.5 |
| **Total P0-P1** | 11 | 620-1190 | 3.8-7.4 |
| **Total P0-P2** | 20 | 1040-1910 | 6.4-11.9 |

### 关键洞察

**1. P1 缺陷集中在 3 个领域**:
- **算法** (D3, D4): 需要 Expert 级别图算法专家
- **性能** (D10, D12): 需要 Senior 性能工程师
- **质量** (D17): 需要 Mid-to-Senior 测试专家

**2. D12 (Bytecode) 是最耗时的 P1 缺陷**:
- 工作量: 120-240 hours (3-6 weeks)
- 需要稀缺的字节码专家
- 是真实部署的关键瓶颈

**3. 并行化潜力**:
- D5, D7, D10 可以与 D1-D4 并行开发 (不同领域,不同角色)
- D12 可以与 D3 并行开发 (D12 不依赖 D3)
- D17 应该贯穿全程 (所有缺陷修复都需要测试)

**4. P2 缺陷多为增量改进**:
- 大多数 P2 缺陷工作量不大 (20-80 hours)
- 可以在 P0-P1 完成后逐步修复
- M1 (Generics) 工作量较大 (80-120 hours),优先级可考虑提升

---

### 下一步

继续阅读:
- **[5.3-roles-and-teams.md](./5.3-roles-and-teams.md)**: 6 个角色定义, 3 种团队规模, 4 种协作模式, 缺陷到角色分配矩阵
- **[5.4-appendices.md](./5.4-appendices.md)**: 技能到缺陷矩阵, 角色对比表, 术语表

---

**第一部分 b 完成**: 所有 P0-P1 缺陷 (11 个) + 选定 P2 缺陷 (9 个) 分析完毕。

---
